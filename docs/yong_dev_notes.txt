To set up build error, like rake db:migrate
add these entry to ~/.profile, then source ~/.profile

export zoho_key='43a02c5e40acfc842e2e8ed75424ecdf'

=======================================================================================

Create RVM Gemset

ylee@ylee-home-ubuntu:/media/sf_pj-3/md/myd$ rvm --ruby-version --create 2.3.0@domino-web

=======================================================================================

To create the Heroku Postgresql production database for backup/export
ylee@ylee-home-ubuntu:~/hero-postgresql$ heroku pg:backups capture --app domino-production

To export Heroku Postgresql production database
ylee@ylee-home-ubuntu:~/hero-postgresql$ curl -o domino-production-09-15.sql `heroku pg:backups public-url --app domino-production`

See for details: https://devcenter.heroku.com/articles/heroku-postgres-backups



ylee@ylee-home-ubuntu:/media/sf_pj-3/md/myd/db/data_dump$ heroku config:get DATABASE_URL --app domino-production

http://stackoverflow.com/questions/22887524/how-can-i-get-a-plain-text-postgres-database-dump-on-heroku

Look for the Heroku Postgres url (example: HEROKU_POSTGRESQL_RED_URL: postgres://user3123:passkja83kd8@ec2-117-21-174-214.compute-1.amazonaws.com:6212/db982398), which format is postgres://<username>:<password>@<host_name>:<port>/<dbname>.

Next, run this on your command line:

pg_dump --host=<host_name> --port=<port> --username=<username> --password --dbname=<dbname> 



Then locally do:
$ pg_restore --verbose --clean --no-acl --no-owner -h localhost -U myuser -d mydb latest.dump
=======================================================================================

heroku pkbackup dump text format

https://gist.github.com/kagemusha/1569836

Get the Heroku db as detailed here:
http://devcenter.heroku.com/articles/pgbackups#exporting_via_a_backup

1. heroku pgbackups:capture
2. heroku pgbackups:url <backup_num>  #=>backup_url
   -  get backup_num with cmd "heroku pgbackups"
3. curl -o latest.dump <backup_url>

Then locally do:
$ pg_restore --verbose --clean --no-acl --no-owner -h localhost -U myuser -d mydb latest.dump



(your database must exist before can do this)

pg_restore --verbose --clean --no-acl --no-owner -h localhost -U myuser -d mydb latest.dump
=======================================================================================

To dump the fixture data from your database

bundle exec rake db:fixtures:dump

=======================================================================================

Set Rails_ENV in ~/.profile

export RAILS_ENV='production'
env | grep RAILS
=======================================================================================

Steps to setup automated test process for test database 

ylee@ylee-home-ubuntu:/media/sf_pj-3/md/myd$ bundle exec rake util:reset_all_user_password

ylee@ylee-home-ubuntu:/media/sf_pj-3/md/myd$ bundle exec rake db:fixtures:dump

ylee@ylee-home-ubuntu:/media/sf_pj-3/md/myd$ bundle exec rake db:fixtures:load RAILS_ENV=test


=======================================================================================
To use a custom timeout for Rack-timeout, create an initializer file:

# config/initializers/rack_timeout.rb
Rack::Timeout.service_timeout = 5  # seconds
=======================================================================================
Referential Foreign key in models

https://robots.thoughtbot.com/referential-integrity-with-foreign-keys

class User < ActiveRecord::Base
  has_many :posts
  validates :name, presence: true
end

class Post < ActiveRecord::Base
  belongs_to :user
  validates :user, presence: true
end

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================


=======================================================================================


=======================================================================================


=======================================================================================

=======================================================================================


=======================================================================================

=======================================================================================

=======================================================================================

=======================================================================================
