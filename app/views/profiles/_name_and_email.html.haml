-content_for :name_and_email do
  :css
    .invalid-field {
      border-color:red!important;
    }
  .center.white
    .h0.mt3.mb1.light.line-height-1
      Ditch the dirty.
      %br
      Switch to clean.
    .h2.white.mb2 Join the action path to your 100% clean energy lifestyle.

  .clearfix.mx-auto.max-width-2.px2
    =simple_form_for @profile, remote: true, method: @response[:method] do |form|
      .clearfix
        .col.col-6.px2.py1
          %label.white.hide First Name
          =form.input_field :first_name, class: "h3 bg-transparent white rounded height-32 required-field", placeholder: "First name", data: {reg: '\\w', target: '#first-name-error-msg'}
          #first-name-error-msg.display-none.red.m0 
            'First name' is blank
        .col.col-6.px2.py1
          %label.white.hide Last Name
          =form.input_field :last_name, class: "h3 bg-transparent white rounded height-32 required-field", placeholder: "Last name", data: {reg: '\\w', target: '#last-name-error-msg'}
          #last-name-error-msg.display-none.red.m0
            'Last name' is blank
      .clearfix
        .col.col-12.px2.mt1
          %label.white.hide Email Address
          =form.input_field :email, class: "h3 bg-transparent white rounded border border-width-2 border-white height-32 required-field", placeholder: "Email address", data: {reg: '^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$', target: '#email-error-msg'}
          #email-error-msg.display-none.red.m0
            This email is invalid. Please try a valid email address.
      .sm-col.sm-col-12.my3
        .center
          =form.submit "Get started", class: "btn btn-lg btn-primary btn-primary--hover"

-if @browser.device.mobile?
  #name-and-email.mobile-form.pt4{style: 'height: 618px;'}
    .overlay-mobile
    #form-container.relative.z2
      =yield :name_and_email
-else
  #name-and-email
    .video-container.relative
      .overlay-nonmobile
      %video{:autoplay => "", :loop => "", :preload => 'auto', :poster => 'assets/out.jpg', :muted => ""}
        %source{:src => "https://s3-us-west-2.amazonaws.com/mydomino/assets/out_2.mp4", :type => "video/mp4"}
        Your browser does not support the video tag. Please update your browser.
      #form-container.absolute.z2{style: 'top:100px;left:0;right:0'}
        :css
          .invalid-field { border-color:red!important; }
          .fa-play-circle:hover { color: #00ccff; }
        .center.white
          .h0.mt3.mb1.light.line-height-1
            Ditch the dirty. Switch to clean.
          .h2.white.mb2 Join the action path to your 100% clean energy lifestyle.
          %i.fa.fa-play-circle.fa-5x.pointer.mt3
          %p.mt0.white Watch the video

      .absolute.bottom-0.left-0.right-0.clearfix.mx-auto.px2.z2.py1{style: 'background-color: rgba(0,0,0,0.3)'}
        .max-width-4.mx-auto
          =simple_form_for @profile, remote: true, method: @response[:method] do |form|
            .clearfix
              .sm-col.sm-col-12.md-col-6.py1
                .clearfix
                  .col.col-6
                    =form.input_field :first_name, class: "h3 bg-white gray-80 rounded height-32 required-field", placeholder: "First name", data: {reg: '\\w', target: '#first-name-error-msg'}
                    #first-name-error-msg.display-none.red.m0 
                      'First name' is blank
                  .col.col-6.pl1
                    =form.input_field :last_name, class: "h3 bg-white gray-80 rounded height-32 required-field", placeholder: "Last name", data: {reg: '\\w', target: '#last-name-error-msg'}
                    #last-name-error-msg.display-none.red.m0
                      'Last name' is blank
              .sm-col.sm-col-12.md-col-6.py1
                .clearfix
                  .col.col-6.md-col-8.md-pl1
                    =form.input_field :email, class: "h3 bg-white gray-80 rounded border border-width-2 border-white height-32 required-field", placeholder: "Email address", data: {reg: '^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$', target: '#email-error-msg'}
                    #email-error-msg.display-none.red.m0
                      This email is invalid.
                  .col.col-6.md-col-4.pl1
                    =form.submit "Get started", id: 'btn-begin-onboard', class: "btn btn-md btn-primary btn-primary--hover",style: "height:42px;line-height: 0.6rem;width:100%;"

:javascript
  $(document).ready(function(){
    logoColors.startColors.text = '#fff';
    logoColors.startColors.penguin = '#fff';
    navbarScroll('#FFFFFF', '#666');

    var $requiredFields = $('.required-field');

    $('#btn-begin-onboard').on('click', function(e){
      e.preventDefault();
      if (validateRequiredFields($requiredFields)){ 
        $(".simple_form").submit();
      }
    });

    var validateRequiredFields = function($fields){
      $.each($fields,function(index, value){
        patt = new RegExp($(value).data('reg'));
        if(patt.test($(value).val()) == false  ){
          $(value).addClass('invalid-field');
          $($(value).data('target')).removeClass('display-none');
        }
      });
      return $('.invalid-field').length == 0 ? true : false;
    };

    $requiredFields.bind('input change propertychange', function(){
      patt = new RegExp($(this).data('reg'));
      if(patt.test($(this).val()) == true ){
        $(this).removeClass('invalid-field');
        $($(this).data('target')).addClass('display-none');
      }
    });
    
    //submit buttons may not be pushed multiple times
    $(".simple_form").submit(function() {
      $(this).submit(function() {
        return false;
      });
      return true;
    });
  });